{% extends 'base.html' %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

{% block content %}
<form action="" method="post">
    {{ form.hidden_tag() }}
    <p>
        {{ form.accounts.label }}
        {{ form.accounts(cols=32, rows=4) }}
        {% for error in form.accounts.errors %}
        <span style="color: black;">{{ error }}</span>
        {% endfor %}
    </p>
    <p>
        {{ form.submit() }}
    </p>
</form>


<ul id="accountList"></ul>


<hr>
<form action="" method="post">
    {{ form3.hidden_tag() }}
    <p>
        {{ form3.regex.label }}
        {{ form3.regex(size=32) }}
        {% for error in form3.regex.errors %}
        <span style="color: red;">{{ error }}</span>
        {% endfor %}
    </p>
    <p>{{ form3.submit() }}</p>
</form>

<ul id="keysList"></ul>

<hr>
<button id="butt">Get the tweets!</button>
<div id="answer"></div>
{% endblock %}

{% block script %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
<script src="http://ajax.microsoft.com/ajax/jquery.templates/beta1/jquery.tmpl.min.js"></script>
<script id="accountTemplate">
    <li>${account} (${id} - id)</li>
</script>

<script id="keysTemplate">
    <li>${regex} (${id} - id)</li>
</script>



<script>
   $(document).ready(function() {
        $('#butt').click(function() {
            $.ajax({
                url: '/process',
                type: 'GET'
            }).done(function(data) {
                $('#answer').text(data.output)
            });
        });
    });


   $(document).ready(function() {
        $('.btn').click(function() {
            var id = $(this).attr('id');
            $.ajax({
                url: '/delete_accounts',
                type: 'GET',
                data: {'id': id}
            }).done(function(data) {
                $('.tw').text(data.output)
            });
        });
    });

  $(document).ready(function() {
       $.ajax({
           url: '/get_accounts',
           type: 'GET'
       }).done(function(res) {
           var accountObj = JSON.parse(res);
           $('#accountTemplate').tmpl(accountObj).appendTo( "#accountList" );
       });
  });

  $(document).ready(function() {
       $.ajax({
           url: '/get_keys',
           type: 'GET'
       }).done(function(res) {
           var keysObj = JSON.parse(res);
           $('#keysTemplate').tmpl(keysObj).appendTo( "#keysList" );
       });
  });


</script>

{% endblock %}

